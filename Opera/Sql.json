

{"SQLID":600000158,"OperationSQL":"Delete PATHWAY Where SYSTEM_ID = 100\r\n\r\nInsert Into PATHWAY\r\n\t(\r\n\tRECORD_ID\r\n\t,SYSTEM_ID\r\n\t,SOURCE_ID\r\n\t,PATIENT_SOURCE_ID\r\n\t,ADDED_DATE_TIME\r\n\t,MODIFIED_DATE_TIME\r\n--Detail\r\n\t,PATIENT_PATHWAY_IDENTIFIER\r\n\t,ORGANISATION_CODE_PATIENT_PATHWAY_IDENTIFIER_ISSUER\r\n\t,PREV_PATIENT_PATHWAY_IDENTIFIER\r\n--Current Per\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_START_DATE\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_STOP_DATE\r\n\t,BREACH_DATE\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS_DESC\r\n--Local Values\r\n\t,EPISODE_TYPE\r\n\t,EPISODE_STATUS\r\n\t,SERVICE_CATEGORY\r\n\t)\r\n--PATHWAYS\r\nSelect\r\n\tRECORD_ID = ROW_NUMBER() Over (PARTITION BY 1 Order By e.UBRN) + 10000000000\r\n\t,100 SYSTEM_ID\r\n\t,SOURCE_ID = UBRN\r\n\t,PATIENT_SOURCE_ID = Replace(NHS_Number,' ','')\r\n\t,ADDED_DATE_TIME = FileDate\r\n\t,MODIFIED_DATE_TIME = FileDate\r\n--Detail\r\n\t,PATIENT_PATHWAY_IDENTIFIER = UBRN\r\n\t,ORGANISATION_CODE_PATIENT_PATHWAY_IDENTIFIER_ISSUER = 'ASI'\r\n\t,PREV_PATIENT_PATHWAY_IDENTIFIER = UBRN\r\n--Current Per\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_START_DATE = EReferral_Pathway_Start_Date\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_STOP_DATE = Null\r\n\t,BREACH_DATE = Null --Can we calculate this?\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS = '10'\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS_DESC = 'ASI Clock Start' --Check actual desc to ensure match\r\n--Local Values\r\n\t,EPISODE_TYPE = 'ASI'\r\n\t,EPISODE_STATUS = 'ASI'\r\n\t,SERVICE_CATEGORY = 'ASI' --Map Specialty Here?\r\n--Others\r\n--Select Count(*),Count(Distinct(UBRN))\r\n--Select *\r\nFrom\r\n\tasi.REFERRALS e\r\n\r\n"}
{"SQLID":400000408,"OperationSQL":"USE BEDROCk\r\nGO\r\n\r\n--Alter Table SLAM_DETAIL\r\n--Add ACTIVITY_IDENTIFIER Varchar(20)\r\n--,NHSE_POD_CODE Varchar(20)\r\n\r\nTruncate Table inp_ACM_PATIENT_LEVEL_CCP\r\nGo\r\n\r\n--Adults\r\n\r\nINSERT INTO inp_ACM_PATIENT_LEVEL_CCP (\r\n       [ROW_ID]\r\n       ,[DATE_ENTERED]\r\n       ,[RECORD_ID]\r\n       ,[SYSTEM_ID]\r\n       ,[SUS_ACTIVITY_ID]\r\n       ,[ACTIVITY_IDENTIFIER]\r\n       ,[ENCNTR_ID]\r\n       ,[EPISODE_NUMBER]\r\n       ,[SITE]\r\n       ,[SPECIALTY_CODE_MAIN]\r\n       ,[SPECIALTY_CODE_LOCAL]\r\n       ,[SPECIALTY_CODE_SUB]\r\n       ,[ACTIVITY_TREATMENT_FUNCTION_CODE]\r\n       ,[ACTIVITY_TREATMENT_FUNCTION_CODE_LOCAL]\r\n       ,[CONSULTANT_CODE]\r\n       ,[HA_CODE]\r\n       ,[ORIGINATING_CCG_CODE]\r\n       ,[COMMISSIONER_CODE]\r\n       ,[COMMISSIONER_CODE_LOCAL]\r\n       ,[COMMISSIONER_CODE_ORIGINAL]\r\n       ,[REGISTERED_PRACTICE_CODE]\r\n       ,[CONTRACT_CODE]\r\n       ,[POD_CODE_LOCAL]\r\n       ,[POD_CODE_NHSE]\r\n       ,[HRG_CODE]\r\n       ,[HRG_CODE_LOCAL]\r\n       ,[UNBUNDLED_HRG_CODE]\r\n       ,[ATTENDANCE_HRG]\r\n       ,[SPELL_REPORT_FLAG]\r\n       ,[ACTIVITY_DATE_TIME]\r\n       ,[ACTIVITY_DATE_ID]\r\n       ,[ACTIVITY_DATE]\r\n       ,[ACTIVITY_VOLUME]\r\n       ,[SLID_CODE]\r\n       ,[SLID_CODE_LOCAL]\r\n       ,[NPOC]\r\n       ,[NPOC_LOCAL]\r\n       ,[TARGET_CODE]\r\n       ,[SPECSERVICE_ID]\r\n       ,[SPECSERVICE_ID_2]\r\n       ,[SPECSERVICE_ID_3]\r\n       ,[SPECSERVICE_ID_4]\r\n       ,[SPECSERVICE_ID_5]\r\n       ,[SPECSERVICE_ID_6]\r\n       ,[SPECSERVICE_ID_7]\r\n       ,[SPECSERVICE_ID_8]\r\n       ,[SPECSERVICE_ID_9]\r\n       ,[SPECSERVICE_ID_10]\r\n       ,[SPECSERVICE_ID_11]\r\n       ,[SPECSERVICE_ID_12]\r\n       ,[SPECSERVICE_ID_13]\r\n       ,[SPECSERVICE_ID_14]\r\n       ,[SPECSERVICE_ID_15]\r\n       ,[SPECSERVICE_ID_16]\r\n       ,[SPECSERVICE_ID_17]\r\n       ,[SPECSERVICE_ID_18]\r\n       ,[SPECSERVICE_ID_19]\r\n       ,[SPECSERVICE_ID_20]\r\n       ,[SPECSERVICE_ID_21]\r\n       ,[LENGTH_OF_SPELL]\r\n       ,[LENGTH_OF_EPISODE]\r\n       ,[TRIMPOINT_EL]\r\n       ,[TRIMPOINT_NEL]\r\n       ,[EXCESS_BED_DAYS_EL]\r\n       ,[EXCESS_BED_DAYS_NEL]\r\n       ,[EXCESS_BED_DAYS]\r\n       ,[REPORT_MASTER_ID]\r\n       ,[USER_DEFINED_ACTIVITY_CODE_01]\r\n       ,[USER_DEFINED_ACTIVITY_CODE_02]\r\n       ,[USER_DEFINED_ACTIVITY_CODE_03]\r\n       ,[ADMISSION_DATE_TIME]\r\n       ,[ADMISSION_DATE]\r\n       ,[ADMISSION_DATE_ID]\r\n       ,[DISCHARGE_DATE_TIME]\r\n       ,[DISCHARGE_DATE]\r\n       ,[DISCHARGE_DATE_ID]\r\n       ,[EPISODE_START_DATE_TIME]\r\n       ,[EPISODE_START_DATE]\r\n       ,[EPISODE_START_DATE_ID]\r\n       ,[EPISODE_END_DATE_TIME]\r\n       ,[EPISODE_END_DATE]\r\n       ,[EPISODE_END_DATE_ID]\r\n       ,[PATIENT_CLASS_CODE]\r\n       ,[ADMISSION_METHOD_CODE]\r\n       ,[INTENDED_MANAGEMENT_CODE]\r\n       ,[FIRST_REGULAR_DAY_OR_NIGHT_ADMISSION]\r\n       ,[WEIGHT]\r\n       ,[IS_READMISSION]\r\n       ,[READMISSION_DAYS]\r\n       ,[SERVICE_LINE_CODE]\r\n       ,[PERSON_ID]\r\n       ,[HOSPITAL_NUMBER]\r\n       ,[NHS_NUMBER]\r\n       ,[AGE_AT_ACTIVITY_DATE]\r\n       ,[DATE_OF_BIRTH]\r\n       ,[PATIENT_GENDER]\r\n       ,[PATIENT_POSTCODE]\r\n       ,[CLINIC_CODE]\r\n       ,[WARD_CODE_ADMISSION]\r\n       ,[WARD_CODE_DISCHARGE]\r\n       ,[ICD10_CODE]\r\n       ,[OPCS_CODE]\r\n       ,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_01]\r\n       ,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_02]\r\n       ,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_03]\r\n       ,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_04]\r\n       ,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_05]\r\n       ,[PSEUDONYMISED_REPORT_MASTER_ID]\r\n       ,[REFERRAL_SOURCE_CODE]\r\n       ,[PATHWAY_ID]\r\n       ,[SERVICE_CLASS_CODE]\r\n       ,[MOD_FLAG]\r\n       ,[MOD_FLAG_LOCAL]\r\n       ,[JUSTICE_FLAG]\r\n       ,[JUSTICE_FLAG_LOCAL]\r\n       ,[SPECIALIST_FLAG]\r\n       ,[SPECIALIST_FLAG_LOCAL]\r\n       ,[PBR]\r\n       ,[APPOINTMENT_TYPE]\r\n       ,[FIRST_ATTENDANCE_CODE]\r\n       ,[ATTENDED_OR_DID_NOT_ATTEND_CODE]\r\n       ,[PRIMARY_PROCEDURE]\r\n       ,[ALL_PROCEDURES]\r\n       ,[APPOINTMENT_FILTER]\r\n       ,[REPORT_GROUP]\r\n       ,[PRIMARY_DIAGNOSIS]\r\n       ,[ALL_DIAGNOSES]\r\n       ,[CCP_TYPE]\r\n       ,[CRITICAL_CARE_START_DATE_TIME]\r\n       ,[CRITICAL_CARE_START_DATE_ID]\r\n       ,[CRITICAL_CARE_DISCHARGE_DATE_TIME]\r\n       ,[CRITICAL_CARE_DISCHARGE_DATE_ID]\r\n       ,[CRITICAL_CARE_ACTIVITY_DATE]\r\n       ,[CRITICAL_CARE_ACTIVITY_DATE_ID]\r\n       ,[CRITICAL_CARE_UNIT_FUNCTION]\r\n       ,[ALL_CRITICAL_CARE_ACTIVITY_CODES]\r\n       ,CRITICAL_CARE_LOCAL_ID\r\n       ,[OVERSEAS_VISITOR_STATUS]\r\n       ,[STATUS]\r\n       ,[ADMINISTRATIVE_CATEGORY_CODE]\r\n       ,[DATA_QUALITY_FLAG]\r\n       ,[LOCAL_FLAG]\r\n       ,[PATHWAY_TYPE]\r\n       ,[CONSULTANT_NAME]\r\n       ,[CHANGE_LOG]\r\n       ,[WARD_NAME_ADMISSION]\r\n       ,[WARD_NAME_DISCHARGE]\r\n       ,[CRITICAL_CARE_BED_DAYS]\r\n       ,[REHAB_BED_DAYS]\r\n       ,[EXCESS_BED_DAYS_ADJUSTED]\r\n       ,[PRIVATE_PATIENT_FLAG]\r\n       ,[CURRENT_PERMANENT_RESIDENCE_UK_FLAG]\r\n       ,[OVERSEAS_VISITOR_CHARGEABLE_FLAG]\r\n       ,[OVERSEAS_VISITOR_NONCHARGEABLE_FLAG]\r\n       ,[PAYING_PATIENT_FLAG]\r\n       )\r\nSELECT  acm.[ROW_ID]\r\n       ,acm.[DATE_ENTERED]\r\n       ,acm.[RECORD_ID]\r\n       ,acm.[SYSTEM_ID]\r\n       ,acm.[SUS_ACTIVITY_ID]\r\n       ,acm.[ACTIVITY_IDENTIFIER]\r\n       ,acm.[ENCNTR_ID]\r\n       ,acm.[EPISODE_NUMBER]\r\n       ,acm.[SITE]\r\n       ,acm.[SPECIALTY_CODE_MAIN]\r\n       ,acm.[SPECIALTY_CODE_LOCAL]\r\n       ,acm.[SPECIALTY_CODE_SUB]\r\n       ,acm.[ACTIVITY_TREATMENT_FUNCTION_CODE]\r\n       ,acm.[ACTIVITY_TREATMENT_FUNCTION_CODE_LOCAL]\r\n       ,acm.[CONSULTANT_CODE]\r\n       ,acm.[HA_CODE]\r\n       ,acm.[ORIGINATING_CCG_CODE]\r\n       ,acm.[COMMISSIONER_CODE]\r\n       ,acm.[COMMISSIONER_CODE_LOCAL]\r\n       ,acm.[COMMISSIONER_CODE_ORIGINAL]\r\n       ,acm.[REGISTERED_PRACTICE_CODE]\r\n       ,acm.[CONTRACT_CODE]\r\n       ,acm.[POD_CODE_LOCAL]\r\n       ,acm.[POD_CODE_NHSE]\r\n       ,cchrg.ACC_HRG\r\n       ,acm.[HRG_CODE_LOCAL]\r\n       ,acm.[UNBUNDLED_HRG_CODE]\r\n       ,acm.[ATTENDANCE_HRG]\r\n       ,acm.[SPELL_REPORT_FLAG]\r\n       ,acm.[ACTIVITY_DATE_TIME]\r\n       ,acm.[ACTIVITY_DATE_ID]\r\n       ,acm.[ACTIVITY_DATE]\r\n       ,acm.[ACTIVITY_VOLUME]\r\n       ,acm.[SLID_CODE]\r\n       ,acm.[SLID_CODE_LOCAL]\r\n       ,acm.[NPOC]\r\n       ,acm.[NPOC_LOCAL]\r\n       ,acm.[TARGET_CODE]\r\n       ,acm.[SPECSERVICE_ID]\r\n       ,acm.[SPECSERVICE_ID_2]\r\n       ,acm.[SPECSERVICE_ID_3]\r\n       ,acm.[SPECSERVICE_ID_4]\r\n       ,acm.[SPECSERVICE_ID_5]\r\n       ,acm.[SPECSERVICE_ID_6]\r\n       ,acm.[SPECSERVICE_ID_7]\r\n       ,acm.[SPECSERVICE_ID_8]\r\n       ,acm.[SPECSERVICE_ID_9]\r\n       ,acm.[SPECSERVICE_ID_10]\r\n       ,acm.[SPECSERVICE_ID_11]\r\n       ,acm.[SPECSERVICE_ID_12]\r\n       ,acm.[SPECSERVICE_ID_13]\r\n       ,acm.[SPECSERVICE_ID_14]\r\n       ,acm.[SPECSERVICE_ID_15]\r\n       ,acm.[SPECSERVICE_ID_16]\r\n       ,acm.[SPECSERVICE_ID_17]\r\n       ,acm.[SPECSERVICE_ID_18]\r\n       ,acm.[SPECSERVICE_ID_19]\r\n       ,acm.[SPECSERVICE_ID_20]\r\n       ,acm.[SPECSERVICE_ID_21]\r\n       ,acm.[LENGTH_OF_SPELL]\r\n       ,acm.[LENGTH_OF_EPISODE]\r\n       ,acm.[TRIMPOINT_EL]\r\n       ,acm.[TRIMPOINT_NEL]\r\n       ,acm.[EXCESS_BED_DAYS_EL]\r\n       ,acm.[EXCESS_BED_DAYS_NEL]\r\n       ,acm.[EXCESS_BED_DAYS]\r\n       ,acm.[REPORT_MASTER_ID]\r\n       ,acm.[USER_DEFINED_ACTIVITY_CODE_01]\r\n       ,acm.[USER_DEFINED_ACTIVITY_CODE_02]\r\n       ,acm.[USER_DEFINED_ACTIVITY_CODE_03]\r\n       ,acm.[ADMISSION_DATE_TIME]\r\n       ,acm.[ADMISSION_DATE]\r\n       ,acm.[ADMISSION_DATE_ID]\r\n       ,acm.[DISCHARGE_DATE_TIME]\r\n       ,acm.[DISCHARGE_DATE]\r\n       ,acm.[DISCHARGE_DATE_ID]\r\n       ,acm.[EPISODE_START_DATE_TIME]\r\n       ,acm.[EPISODE_START_DATE]\r\n       ,acm.[EPISODE_START_DATE_ID]\r\n       ,acm.[EPISODE_END_DATE_TIME]\r\n       ,acm.[EPISODE_END_DATE]\r\n       ,acm.[EPISODE_END_DATE_ID]\r\n       ,acm.[PATIENT_CLASS_CODE]\r\n       ,acm.[ADMISSION_METHOD_CODE]\r\n       ,acm.[INTENDED_MANAGEMENT_CODE]\r\n       ,acm.[FIRST_REGULAR_DAY_OR_NIGHT_ADMISSION]\r\n       ,acm.[WEIGHT]\r\n       ,acm.[IS_READMISSION]\r\n       ,acm.[READMISSION_DAYS]\r\n       ,acm.[SERVICE_LINE_CODE]\r\n       ,acm.[PERSON_ID]\r\n       ,acm.[HOSPITAL_NUMBER]\r\n       ,acm.[NHS_NUMBER]\r\n       ,acm.[AGE_AT_ACTIVITY_DATE]\r\n       ,acm.[DATE_OF_BIRTH]\r\n       ,acm.[PATIENT_GENDER]\r\n       ,acm.[PATIENT_POSTCODE]\r\n       ,acm.[CLINIC_CODE]\r\n       ,acm.[WARD_CODE_ADMISSION]\r\n       ,acm.[WARD_CODE_DISCHARGE]\r\n       ,acm.[ICD10_CODE]\r\n       ,acm.[OPCS_CODE]\r\n       ,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_01]\r\n       ,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_02]\r\n       ,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_03]\r\n       ,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_04]\r\n       ,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_05]\r\n       ,acm.[PSEUDONYMISED_REPORT_MASTER_ID]\r\n       ,acm.[REFERRAL_SOURCE_CODE]\r\n       ,acm.[PATHWAY_ID]\r\n       ,acm.[SERVICE_CLASS_CODE]\r\n       ,acm.[MOD_FLAG]\r\n       ,acm.[MOD_FLAG_LOCAL]\r\n       ,acm.[JUSTICE_FLAG]\r\n       ,acm.[JUSTICE_FLAG_LOCAL]\r\n       ,acm.[SPECIALIST_FLAG]\r\n       ,acm.[SPECIALIST_FLAG_LOCAL]\r\n       ,acm.[PBR]\r\n       ,acm.[APPOINTMENT_TYPE]\r\n       ,acm.[FIRST_ATTENDANCE_CODE]\r\n       ,acm.[ATTENDED_OR_DID_NOT_ATTEND_CODE]\r\n       ,acm.[PRIMARY_PROCEDURE]\r\n       ,acm.[ALL_PROCEDURES]\r\n       ,acm.[APPOINTMENT_FILTER]\r\n       ,acm.[REPORT_GROUP]\r\n       ,acm.[PRIMARY_DIAGNOSIS]\r\n       ,acm.[ALL_DIAGNOSES]\r\n       ,'ACC' [CCP_TYPE] --cchrg.CCPTYPE\r\n       ,Isnull(cchrg.CC_Start_Date, cc.[CRITICAL_CARE_ACTIVITY_DATE]) [CRITICAL_CARE_START_DATE_TIME] --[CRITICAL_CARE_START_DATE_TIME]\r\n       ,Convert(VARCHAR(8), Isnull(cchrg.CC_Start_Date, cc.[CRITICAL_CARE_ACTIVITY_DATE]), 112) [CRITICAL_CARE_START_DATE_ID] --[CRITICAL_CARE_DISCHARGE_DATE_TIME]\r\n       ,cchrg.CC_Discharge_Date-- [CRITICAL_CARE_DISCHARGE_DATE_TIME]\r\n       ,Convert(VARCHAR(8), cchrg.CC_Discharge_Date, 112) [CRITICAL_CARE_DISCHARGE_DATE_ID]\r\n       ,Isnull(cc.[CRITICAL_CARE_ACTIVITY_DATE], cchrg.ACTIVITY_DATE) [CRITICAL_CARE_ACTIVITY_DATE] --cchrg.CRITICAL_CARE_ACTIVITY_DATE\r\n       ,Convert(VARCHAR(8), Isnull(cc.[CRITICAL_CARE_ACTIVITY_DATE], cc.CRITICAL_CARE_START_DATE), 112) [CRITICAL_CARE_ACTIVITY_DATE_ID] --cc.CRITICAL_CARE_PERIOD_START_DATE_TIME\r\n       ,CCUF [CRITICAL_CARE_UNIT_FUNCTION] --cc.[CRITICAL_CARE_UNIT_FUNCTION]\r\n       ,convert(varchar(255),null) [ALL_CRITICAL_CARE_ACTIVITY_CODES] --cchrg.[ALL_CRITICAL_CARE_ACTIVITY_CODES]\r\n       ,NULL CRITICAL_CARE_LOCAL_ID\r\n       ,acm.[OVERSEAS_VISITOR_STATUS]\r\n       ,acm.[STATUS]\r\n       ,acm.[ADMINISTRATIVE_CATEGORY_CODE]\r\n       ,acm.[DATA_QUALITY_FLAG]\r\n       ,acm.[LOCAL_FLAG]\r\n       ,acm.[PATHWAY_TYPE]\r\n       ,acm.[CONSULTANT_NAME]\r\n       ,acm.[CHANGE_LOG]\r\n       ,acm.[WARD_NAME_ADMISSION]\r\n       ,acm.[WARD_NAME_DISCHARGE]\r\n       ,acm.[CRITICAL_CARE_BED_DAYS]\r\n       ,acm.[REHAB_BED_DAYS]\r\n       ,acm.[EXCESS_BED_DAYS_ADJUSTED]\r\n       ,acm.[PRIVATE_PATIENT_FLAG]\r\n       ,acm.[CURRENT_PERMANENT_RESIDENCE_UK_FLAG]\r\n       ,acm.[OVERSEAS_VISITOR_CHARGEABLE_FLAG]\r\n       ,acm.[OVERSEAS_VISITOR_NONCHARGEABLE_FLAG]\r\n       ,acm.[PAYING_PATIENT_FLAG]\r\n--Select count(*)\r\nFROM inp_ACM_PATIENT_LEVEL_IP acm WITH (NOLOCK)\r\nINNER JOIN INP_HRG4_ACC  cchrg    --WHERE RECORD_ID  =9000000009995 -- [BEDROCK_GROUPER].[inp].[HRG4_CC]\r\n                     ON acm.RECORD_ID=cchrg.RECORD_ID\r\n                  --   AND cchrg.CCPTYPE = 'ACC'\r\n  INNER JOIN INP_NEONATAL_CRITICAL_CARE_DAILY_ACTIVITY_CE_ONLY CC -- [SDR_EPIC].[dbo].CRITICAL_CARE_ADULT_DAILY_EPISODE\r\n  ON cchrg.RECORD_ID=CC.CONSULTANT_EPISODE_HOSPITAL_PROVIDER_SPELL_RECORD_id\r\n  --AND cc.CRITICAL_CARE_PERIOD_END_DATE_TIME=cchrg.CRITICAL_CARE_DISCHARGE_DATE_TIME\r\n  AND cc.CRITICAL_CARE_START_DATE=cchrg.CC_Start_Date\r\n--  where cc.CONSULTANT_EPISODE_HOSPITAL_PROVIDER_SPELL_RECORD_ID=9000000009995\r\n\r\n--Neonates\r\nInsert Into inp_ACM_PATIENT_LEVEL_CCP\r\n\t(\r\n\t[ROW_ID]\r\n\t,[DATE_ENTERED]\r\n\t,[RECORD_ID]\r\n\t,[SYSTEM_ID]\r\n\t,[SUS_ACTIVITY_ID]\r\n\t,[ACTIVITY_IDENTIFIER]\r\n\t,[ENCNTR_ID]\r\n\t,[EPISODE_NUMBER]\r\n\t,[SITE]\r\n\t,[SPECIALTY_CODE_MAIN]\r\n\t,[SPECIALTY_CODE_LOCAL]\r\n\t,[SPECIALTY_CODE_SUB]\r\n\t,[ACTIVITY_TREATMENT_FUNCTION_CODE]\r\n\t,[ACTIVITY_TREATMENT_FUNCTION_CODE_LOCAL]\r\n\t,[CONSULTANT_CODE]\r\n\t,[HA_CODE]\r\n\t,[ORIGINATING_CCG_CODE]\r\n\t,[COMMISSIONER_CODE]\r\n\t,[COMMISSIONER_CODE_LOCAL]\r\n\t,[COMMISSIONER_CODE_ORIGINAL]\r\n\t,[REGISTERED_PRACTICE_CODE]\r\n\t,[CONTRACT_CODE]\r\n\t,[POD_CODE_LOCAL]\r\n\t,[POD_CODE_NHSE]\r\n\t,[HRG_CODE]\r\n\t,[HRG_CODE_LOCAL]\r\n\t,[UNBUNDLED_HRG_CODE]\r\n\t,[ATTENDANCE_HRG]\r\n\t,[SPELL_REPORT_FLAG]\r\n\t,[ACTIVITY_DATE_TIME]\r\n\t,[ACTIVITY_DATE_ID]\r\n\t,[ACTIVITY_DATE]\r\n\t,[ACTIVITY_VOLUME]\r\n\t,[SLID_CODE]\r\n\t,[SLID_CODE_LOCAL]\r\n\t,[NPOC]\r\n\t,[NPOC_LOCAL]\r\n\t,[TARGET_CODE]\r\n\t,[SPECSERVICE_ID]\r\n\t,[SPECSERVICE_ID_2]\r\n\t,[SPECSERVICE_ID_3]\r\n\t,[SPECSERVICE_ID_4]\r\n\t,[SPECSERVICE_ID_5]\r\n\t,[SPECSERVICE_ID_6]\r\n\t,[SPECSERVICE_ID_7]\r\n\t,[SPECSERVICE_ID_8]\r\n\t,[SPECSERVICE_ID_9]\r\n\t,[SPECSERVICE_ID_10]\r\n\t,[SPECSERVICE_ID_11]\r\n\t,[SPECSERVICE_ID_12]\r\n\t,[SPECSERVICE_ID_13]\r\n\t,[SPECSERVICE_ID_14]\r\n\t,[SPECSERVICE_ID_15]\r\n\t,[SPECSERVICE_ID_16]\r\n\t,[SPECSERVICE_ID_17]\r\n\t,[SPECSERVICE_ID_18]\r\n\t,[SPECSERVICE_ID_19]\r\n\t,[SPECSERVICE_ID_20]\r\n\t,[SPECSERVICE_ID_21]\r\n\t,[LENGTH_OF_SPELL]\r\n\t,[LENGTH_OF_EPISODE]\r\n\t,[TRIMPOINT_EL]\r\n\t,[TRIMPOINT_NEL]\r\n\t,[EXCESS_BED_DAYS_EL]\r\n\t,[EXCESS_BED_DAYS_NEL]\r\n\t,[EXCESS_BED_DAYS]\r\n\t,[REPORT_MASTER_ID]\r\n\t,[USER_DEFINED_ACTIVITY_CODE_01]\r\n\t,[USER_DEFINED_ACTIVITY_CODE_02]\r\n\t,[USER_DEFINED_ACTIVITY_CODE_03]\r\n\t,[ADMISSION_DATE_TIME]\r\n\t,[ADMISSION_DATE]\r\n\t,[ADMISSION_DATE_ID]\r\n\t,[DISCHARGE_DATE_TIME]\r\n\t,[DISCHARGE_DATE]\r\n\t,[DISCHARGE_DATE_ID]\r\n\t,[EPISODE_START_DATE_TIME]\r\n\t,[EPISODE_START_DATE]\r\n\t,[EPISODE_START_DATE_ID]\r\n\t,[EPISODE_END_DATE_TIME]\r\n\t,[EPISODE_END_DATE]\r\n\t,[EPISODE_END_DATE_ID]\r\n\t,[PATIENT_CLASS_CODE]\r\n\t,[ADMISSION_METHOD_CODE]\r\n\t,[INTENDED_MANAGEMENT_CODE]\r\n\t,[FIRST_REGULAR_DAY_OR_NIGHT_ADMISSION]\r\n\t,[WEIGHT]\r\n\t,[IS_READMISSION]\r\n\t,[READMISSION_DAYS]\r\n\t,[SERVICE_LINE_CODE]\r\n\t,[PERSON_ID]\r\n\t,[HOSPITAL_NUMBER]\r\n\t,[NHS_NUMBER]\r\n\t,[AGE_AT_ACTIVITY_DATE]\r\n\t,[DATE_OF_BIRTH]\r\n\t,[PATIENT_GENDER]\r\n\t,[PATIENT_POSTCODE]\r\n\t,[CLINIC_CODE]\r\n\t,[WARD_CODE_ADMISSION]\r\n\t,[WARD_CODE_DISCHARGE]\r\n\t,[ICD10_CODE]\r\n\t,[OPCS_CODE]\r\n\t,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_01]\r\n\t,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_02]\r\n\t,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_03]\r\n\t,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_04]\r\n\t,[USER_DEFINED_ACTUAL_ACTIVITY_CODE_05]\r\n\t,[PSEUDONYMISED_REPORT_MASTER_ID]\r\n\t,[REFERRAL_SOURCE_CODE]\r\n\t,[PATHWAY_ID]\r\n\t,[SERVICE_CLASS_CODE]\r\n\t,[MOD_FLAG]\r\n\t,[MOD_FLAG_LOCAL]\r\n\t,[JUSTICE_FLAG]\r\n\t,[JUSTICE_FLAG_LOCAL]\r\n\t,[SPECIALIST_FLAG]\r\n\t,[SPECIALIST_FLAG_LOCAL]\r\n\t,[PBR]\r\n\t,[APPOINTMENT_TYPE]\r\n\t,[FIRST_ATTENDANCE_CODE]\r\n\t,[ATTENDED_OR_DID_NOT_ATTEND_CODE]\r\n\t,[PRIMARY_PROCEDURE]\r\n\t,[ALL_PROCEDURES]\r\n\t,[APPOINTMENT_FILTER]\r\n\t,[REPORT_GROUP]\r\n\t,[PRIMARY_DIAGNOSIS]\r\n\t,[ALL_DIAGNOSES]\r\n\t,[CCP_TYPE]\r\n\t,[CRITICAL_CARE_START_DATE_TIME]\r\n\t,[CRITICAL_CARE_START_DATE_ID]\r\n\t,[CRITICAL_CARE_DISCHARGE_DATE_TIME]\r\n\t,[CRITICAL_CARE_DISCHARGE_DATE_ID]\r\n\t,[CRITICAL_CARE_ACTIVITY_DATE]\r\n\t,[CRITICAL_CARE_ACTIVITY_DATE_ID]\r\n\t,[CRITICAL_CARE_UNIT_FUNCTION]\r\n\t,[ALL_CRITICAL_CARE_ACTIVITY_CODES]\r\n\t,CRITICAL_CARE_LOCAL_ID\r\n\t,[OVERSEAS_VISITOR_STATUS]\r\n\t,[STATUS]\r\n\t,[ADMINISTRATIVE_CATEGORY_CODE]\r\n\t,[DATA_QUALITY_FLAG]\r\n\t,[LOCAL_FLAG]\r\n\t,[PATHWAY_TYPE]\r\n\t,[CONSULTANT_NAME]\r\n\t,[CHANGE_LOG]\r\n\t,[WARD_NAME_ADMISSION]\r\n\t,[WARD_NAME_DISCHARGE]\r\n\t,[CRITICAL_CARE_BED_DAYS]\r\n\t,[REHAB_BED_DAYS]\r\n\t,[EXCESS_BED_DAYS_ADJUSTED]\r\n\t,[PRIVATE_PATIENT_FLAG]\r\n\t,[CURRENT_PERMANENT_RESIDENCE_UK_FLAG]\r\n\t,[OVERSEAS_VISITOR_CHARGEABLE_FLAG]\r\n\t,[OVERSEAS_VISITOR_NONCHARGEABLE_FLAG]\r\n\t,[PAYING_PATIENT_FLAG]\r\n\t)\r\nSELECT Distinct\r\n\tacm.[ROW_ID]\r\n\t,acm.[DATE_ENTERED]\r\n\t,acm.[RECORD_ID]\r\n\t,acm.[SYSTEM_ID]\r\n\t,acm.[SUS_ACTIVITY_ID]\r\n\t,acm.[ACTIVITY_IDENTIFIER]\r\n\t,acm.[ENCNTR_ID]\r\n\t,acm.[EPISODE_NUMBER]\r\n\t,acm.[SITE]\r\n\t,acm.[SPECIALTY_CODE_MAIN]\r\n\t,acm.[SPECIALTY_CODE_LOCAL]\r\n\t,acm.[SPECIALTY_CODE_SUB]\r\n\t,acm.[ACTIVITY_TREATMENT_FUNCTION_CODE]\r\n\t,acm.[ACTIVITY_TREATMENT_FUNCTION_CODE_LOCAL]\r\n\t,acm.[CONSULTANT_CODE]\r\n\t,acm.[HA_CODE]\r\n\t,acm.[ORIGINATING_CCG_CODE]\r\n\t,acm.[COMMISSIONER_CODE]\r\n\t,acm.[COMMISSIONER_CODE_LOCAL]\r\n\t,acm.[COMMISSIONER_CODE_ORIGINAL]\r\n\t,acm.[REGISTERED_PRACTICE_CODE]\r\n\t,acm.[CONTRACT_CODE]\r\n\t,acm.[POD_CODE_LOCAL]\r\n\t,acm.[POD_CODE_NHSE]\r\n\t,cchrg.NCC_HRG -- [HRG]\r\n\t,acm.[HRG_CODE_LOCAL]\r\n\t,acm.[UNBUNDLED_HRG_CODE]\r\n\t,acm.[ATTENDANCE_HRG]\r\n\t,acm.[SPELL_REPORT_FLAG]\r\n\t,acm.[ACTIVITY_DATE_TIME]\r\n\t,acm.[ACTIVITY_DATE_ID]\r\n\t,acm.[ACTIVITY_DATE]\r\n\t,acm.[ACTIVITY_VOLUME]\r\n\t,acm.[SLID_CODE]\r\n\t,acm.[SLID_CODE_LOCAL]\r\n\t,acm.[NPOC]\r\n\t,acm.[NPOC_LOCAL]\r\n\t,acm.[TARGET_CODE]\r\n\t,acm.[SPECSERVICE_ID]\r\n\t,acm.[SPECSERVICE_ID_2]\r\n\t,acm.[SPECSERVICE_ID_3]\r\n\t,acm.[SPECSERVICE_ID_4]\r\n\t,acm.[SPECSERVICE_ID_5]\r\n\t,acm.[SPECSERVICE_ID_6]\r\n\t,acm.[SPECSERVICE_ID_7]\r\n\t,acm.[SPECSERVICE_ID_8]\r\n\t,acm.[SPECSERVICE_ID_9]\r\n\t,acm.[SPECSERVICE_ID_10]\r\n\t,acm.[SPECSERVICE_ID_11]\r\n\t,acm.[SPECSERVICE_ID_12]\r\n\t,acm.[SPECSERVICE_ID_13]\r\n\t,acm.[SPECSERVICE_ID_14]\r\n\t,acm.[SPECSERVICE_ID_15]\r\n\t,acm.[SPECSERVICE_ID_16]\r\n\t,acm.[SPECSERVICE_ID_17]\r\n\t,acm.[SPECSERVICE_ID_18]\r\n\t,acm.[SPECSERVICE_ID_19]\r\n\t,acm.[SPECSERVICE_ID_20]\r\n\t,acm.[SPECSERVICE_ID_21]\r\n\t,acm.[LENGTH_OF_SPELL]\r\n\t,acm.[LENGTH_OF_EPISODE]\r\n\t,acm.[TRIMPOINT_EL]\r\n\t,acm.[TRIMPOINT_NEL]\r\n\t,acm.[EXCESS_BED_DAYS_EL]\r\n\t,acm.[EXCESS_BED_DAYS_NEL]\r\n\t,acm.[EXCESS_BED_DAYS]\r\n\t,acm.[REPORT_MASTER_ID]\r\n\t,acm.[USER_DEFINED_ACTIVITY_CODE_01]\r\n\t,acm.[USER_DEFINED_ACTIVITY_CODE_02]\r\n\t,acm.[USER_DEFINED_ACTIVITY_CODE_03]\r\n\t,acm.[ADMISSION_DATE_TIME]\r\n\t,acm.[ADMISSION_DATE]\r\n\t,acm.[ADMISSION_DATE_ID]\r\n\t,acm.[DISCHARGE_DATE_TIME]\r\n\t,acm.[DISCHARGE_DATE]\r\n\t,acm.[DISCHARGE_DATE_ID]\r\n\t,acm.[EPISODE_START_DATE_TIME]\r\n\t,acm.[EPISODE_START_DATE]\r\n\t,acm.[EPISODE_START_DATE_ID]\r\n\t,acm.[EPISODE_END_DATE_TIME]\r\n\t,acm.[EPISODE_END_DATE]\r\n\t,acm.[EPISODE_END_DATE_ID]\r\n\t,acm.[PATIENT_CLASS_CODE]\r\n\t,acm.[ADMISSION_METHOD_CODE]\r\n\t,acm.[INTENDED_MANAGEMENT_CODE]\r\n\t,acm.[FIRST_REGULAR_DAY_OR_NIGHT_ADMISSION]\r\n\t,acm.[WEIGHT]\r\n\t,acm.[IS_READMISSION]\r\n\t,acm.[READMISSION_DAYS]\r\n\t,acm.[SERVICE_LINE_CODE]\r\n\t,acm.[PERSON_ID]\r\n\t,acm.[HOSPITAL_NUMBER]\r\n\t,acm.[NHS_NUMBER]\r\n\t,acm.[AGE_AT_ACTIVITY_DATE]\r\n\t,acm.[DATE_OF_BIRTH]\r\n\t,acm.[PATIENT_GENDER]\r\n\t,acm.[PATIENT_POSTCODE]\r\n\t,acm.[CLINIC_CODE]\r\n\t,acm.[WARD_CODE_ADMISSION]\r\n\t,acm.[WARD_CODE_DISCHARGE]\r\n\t,acm.[ICD10_CODE]\r\n\t,acm.[OPCS_CODE]\r\n\t,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_01]\r\n\t,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_02]\r\n\t,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_03]\r\n\t,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_04]\r\n\t,acm.[USER_DEFINED_ACTUAL_ACTIVITY_CODE_05]\r\n\t,acm.[PSEUDONYMISED_REPORT_MASTER_ID]\r\n\t,acm.[REFERRAL_SOURCE_CODE]\r\n\t,acm.[PATHWAY_ID]\r\n\t,acm.[SERVICE_CLASS_CODE]\r\n\t,acm.[MOD_FLAG]\r\n\t,acm.[MOD_FLAG_LOCAL]\r\n\t,acm.[JUSTICE_FLAG]\r\n\t,acm.[JUSTICE_FLAG_LOCAL]\r\n\t,acm.[SPECIALIST_FLAG]\r\n\t,acm.[SPECIALIST_FLAG_LOCAL]\r\n\t,acm.[PBR]\r\n\t,acm.[APPOINTMENT_TYPE]\r\n\t,acm.[FIRST_ATTENDANCE_CODE]\r\n\t,acm.[ATTENDED_OR_DID_NOT_ATTEND_CODE]\r\n\t,acm.[PRIMARY_PROCEDURE]\r\n\t,acm.[ALL_PROCEDURES]\r\n\t,acm.[APPOINTMENT_FILTER]\r\n\t,acm.[REPORT_GROUP]\r\n\t,acm.[PRIMARY_DIAGNOSIS]\r\n\t,acm.[ALL_DIAGNOSES]\r\n\t,'NCC' [CCP_TYPE] --cchrg.CCPTYPE\r\n\t,Isnull(cchrg.CCDate,cchrg.ACTIVITY_DATE) [CRITICAL_CARE_START_DATE_TIME] --Isnull(cchrg.[CRITICAL_CARE_START_DATE_TIME],cchrg.CRITICAL_CARE_ACTIVITY_DATE)\r\n\t,Convert(Varchar(8),Isnull(cchrg.CCDate,cchrg.ACTIVITY_DATE),112) [CRITICAL_CARE_START_DATE_ID] --Convert(Varchar(8),Isnull(cchrg.[CRITICAL_CARE_START_DATE_TIME],cchrg.[CRITICAL_CARE_ACTIVITY_DATE]),112)\r\n\t,cchrg.DISDATE  CRITICAL_CARE_DISCHARGE_DATE_TIME --cchrg.[CRITICAL_CARE_DISCHARGE_DATE_TIME]\r\n\t,Convert(Varchar(8),cchrg.DISDATE,112) [CRITICAL_CARE_DISCHARGE_DATE_ID]  --Convert(Varchar(8),cchrg.[CRITICAL_CARE_DISCHARGE_DATE_TIME],112)\r\n\t,Isnull(cchrg.CCDate,cchrg.ACTIVITY_DATE) [CRITICAL_CARE_ACTIVITY_DATE] --Isnull(cchrg.[CRITICAL_CARE_START_DATE_TIME],cchrg.CRITICAL_CARE_ACTIVITY_DATE)\r\n\t,Convert(Varchar(8),Isnull(cchrg.ACTIVITY_DATE,cchrg.CCDate),112) [CRITICAL_CARE_ACTIVITY_DATE_ID] --Convert(Varchar(8),Isnull(cchrg.[CRITICAL_CARE_ACTIVITY_DATE],cchrg.[CRITICAL_CARE_START_DATE_TIME]),112)\r\n\t,cchrg.CCUF    [CRITICAL_CARE_UNIT_FUNCTION]\r\n\t,cchrg.CCAC_01  [ALL_CRITICAL_CARE_ACTIVITY_CODES]\r\n\t,Null CRITICAL_CARE_LOCAL_ID\r\n\t,acm.[OVERSEAS_VISITOR_STATUS]\r\n\t,acm.[STATUS]\r\n\t,acm.[ADMINISTRATIVE_CATEGORY_CODE]\r\n\t,acm.[DATA_QUALITY_FLAG]\r\n\t,acm.[LOCAL_FLAG]\r\n\t,acm.[PATHWAY_TYPE]\r\n\t,acm.[CONSULTANT_NAME]\r\n\t,acm.[CHANGE_LOG]\r\n\t,acm.[WARD_NAME_ADMISSION]\r\n\t,acm.[WARD_NAME_DISCHARGE]\r\n\t,acm.[CRITICAL_CARE_BED_DAYS]\r\n\t,acm.[REHAB_BED_DAYS]\r\n\t,acm.[EXCESS_BED_DAYS_ADJUSTED]\r\n\t,acm.[PRIVATE_PATIENT_FLAG]\r\n\t,acm.[CURRENT_PERMANENT_RESIDENCE_UK_FLAG]\r\n\t,acm.[OVERSEAS_VISITOR_CHARGEABLE_FLAG]\r\n\t,acm.[OVERSEAS_VISITOR_NONCHARGEABLE_FLAG]\r\n\t,acm.[PAYING_PATIENT_FLAG]\r\n--Select count(*)\r\nFrom\r\n\tinp_ACM_PATIENT_LEVEL_IP acm With(nolock) \r\n\t--Join CCP HRG\r\n\tInner Join INP_HRG4_NCC  cchrg On acm.RECORD_ID = cchrg.RECORD_ID --BEDROCK_GROUPER.[INP].HRG4_CC cchrg\r\n--Where cchrg.CCPTYPE = 'NCC'\r\n\r\n--select * from INP_HRG4_NCC\r\n\r\n"}
{"SQLID":550,"OperationSQL":"exec dbo.usp_DQ_Table 'PATIENT_GP'\r\n"}
{"SQLID":143,"OperationSQL":"exec  [dbo].[usp_AssignSurrogateKeys] 'EMERGENCY_CARE_ATTENDANCE'"}