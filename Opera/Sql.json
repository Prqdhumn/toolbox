

{"SQLID":600000158,"OperationSQL":"Delete PATHWAY Where SYSTEM_ID = 100\r\n\r\nInsert Into PATHWAY\r\n\t(\r\n\tRECORD_ID\r\n\t,SYSTEM_ID\r\n\t,SOURCE_ID\r\n\t,PATIENT_SOURCE_ID\r\n\t,ADDED_DATE_TIME\r\n\t,MODIFIED_DATE_TIME\r\n--Detail\r\n\t,PATIENT_PATHWAY_IDENTIFIER\r\n\t,ORGANISATION_CODE_PATIENT_PATHWAY_IDENTIFIER_ISSUER\r\n\t,PREV_PATIENT_PATHWAY_IDENTIFIER\r\n--Current Per\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_START_DATE\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_STOP_DATE\r\n\t,BREACH_DATE\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS_DESC\r\n--Local Values\r\n\t,EPISODE_TYPE\r\n\t,EPISODE_STATUS\r\n\t,SERVICE_CATEGORY\r\n\t)\r\n--PATHWAYS\r\nSelect\r\n\tRECORD_ID = ROW_NUMBER() Over (PARTITION BY 1 Order By e.UBRN) + 10000000000\r\n\t,100 SYSTEM_ID\r\n\t,SOURCE_ID = UBRN\r\n\t,PATIENT_SOURCE_ID = Replace(NHS_Number,' ','')\r\n\t,ADDED_DATE_TIME = FileDate\r\n\t,MODIFIED_DATE_TIME = FileDate\r\n--Detail\r\n\t,PATIENT_PATHWAY_IDENTIFIER = UBRN\r\n\t,ORGANISATION_CODE_PATIENT_PATHWAY_IDENTIFIER_ISSUER = 'ASI'\r\n\t,PREV_PATIENT_PATHWAY_IDENTIFIER = UBRN\r\n--Current Per\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_START_DATE = EReferral_Pathway_Start_Date\r\n\t,CURRENT_REFERRAL_TO_TREATMENT_PERIOD_STOP_DATE = Null\r\n\t,BREACH_DATE = Null --Can we calculate this?\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS = '10'\r\n\t,REFERRAL_TO_TREATMENT_PERIOD_STATUS_DESC = 'ASI Clock Start' --Check actual desc to ensure match\r\n--Local Values\r\n\t,EPISODE_TYPE = 'ASI'\r\n\t,EPISODE_STATUS = 'ASI'\r\n\t,SERVICE_CATEGORY = 'ASI' --Map Specialty Here?\r\n--Others\r\n--Select Count(*),Count(Distinct(UBRN))\r\n--Select *\r\nFrom\r\n\tasi.REFERRALS e\r\n\r\n"}